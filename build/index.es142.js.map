{"version":3,"file":"index.es142.js","sources":["../node_modules/@gravity-ui/i18n/build/esm/index.js"],"sourcesContent":["import { replaceParams } from './replace-params';\nimport { ErrorCode, mapErrorCodeToMessage } from './translation-helpers';\nimport { isPluralValue } from './types';\nimport pluralizerEn from './plural/en';\nimport pluralizerRu from './plural/ru';\nimport { getPluralValue } from './plural/general';\nexport * from './types';\nexport class I18N {\n    constructor(options = {}) {\n        this.data = {};\n        this.pluralizers = {\n            en: pluralizerEn,\n            ru: pluralizerRu,\n        };\n        this.logger = null;\n        const { data, fallbackLang, lang, logger = null } = options;\n        this.fallbackLang = fallbackLang;\n        this.lang = lang;\n        this.logger = logger;\n        if (data) {\n            Object.entries(data).forEach(([keysetLang, keysetData]) => {\n                this.registerKeysets(keysetLang, keysetData);\n            });\n        }\n    }\n    setLang(lang) {\n        this.lang = lang;\n    }\n    setFallbackLang(fallbackLang) {\n        this.fallbackLang = fallbackLang;\n    }\n    /**\n     * @deprecated Plurals automatically used from Intl.PluralRules. You can safely remove this call. Will be removed in v2.\n     */\n    configurePluralization(pluralizers) {\n        this.pluralizers = Object.assign({}, this.pluralizers, pluralizers);\n    }\n    registerKeyset(lang, keysetName, data = {}) {\n        const isAlreadyRegistered = this.data[lang]\n            && Object.prototype.hasOwnProperty.call(this.data[lang], keysetName);\n        if (isAlreadyRegistered && process.env.NODE_ENV === 'production') {\n            throw new Error(`Keyset '${keysetName}' is already registered, aborting!`);\n        }\n        else if (isAlreadyRegistered) {\n            this.warn(`Keyset '${keysetName}' is already registered.`);\n        }\n        this.data[lang] = Object.assign({}, this.data[lang], { [keysetName]: data });\n    }\n    registerKeysets(lang, data) {\n        Object.keys(data).forEach((keysetName) => {\n            this.registerKeyset(lang, keysetName, data[keysetName]);\n        });\n    }\n    has(keysetName, key, lang) {\n        var _a;\n        const languageData = this.getLanguageData(lang);\n        return Boolean(languageData && languageData[keysetName] && ((_a = languageData[keysetName]) === null || _a === void 0 ? void 0 : _a[key]));\n    }\n    i18n(keysetName, key, params) {\n        if (!this.lang && !this.fallbackLang) {\n            throw new Error('Language is not specified. You should set at least one of these: \"lang\", \"fallbackLang\"');\n        }\n        let text;\n        let details;\n        if (this.lang) {\n            ({ text, details } = this.getTranslationData({ keysetName, key, params, lang: this.lang }));\n            if (details) {\n                const message = mapErrorCodeToMessage({\n                    code: details.code,\n                    lang: this.lang,\n                    fallbackLang: this.fallbackLang === this.lang ? undefined : this.fallbackLang,\n                });\n                this.warn(message, details.keysetName, details.key);\n            }\n        }\n        else {\n            this.warn('Target language is not specified.');\n        }\n        if (text === undefined && this.fallbackLang && this.fallbackLang !== this.lang) {\n            ({ text, details } = this.getTranslationData({\n                keysetName,\n                key,\n                params,\n                lang: this.fallbackLang,\n            }));\n            if (details) {\n                const message = mapErrorCodeToMessage({\n                    code: details.code,\n                    lang: this.fallbackLang,\n                });\n                this.warn(message, details.keysetName, details.key);\n            }\n        }\n        return text !== null && text !== void 0 ? text : key;\n    }\n    keyset(keysetName) {\n        return (key, params) => {\n            return this.i18n(keysetName, key, params);\n        };\n    }\n    warn(msg, keyset, key) {\n        var _a;\n        let cacheKey = '';\n        if (keyset) {\n            cacheKey += keyset;\n            if (key) {\n                cacheKey += `.${key}`;\n            }\n        }\n        else {\n            cacheKey = 'languageData';\n        }\n        (_a = this.logger) === null || _a === void 0 ? void 0 : _a.log(`I18n: ${msg}`, {\n            level: 'info',\n            logger: cacheKey,\n            extra: {\n                type: 'i18n'\n            }\n        });\n    }\n    getLanguageData(lang) {\n        const langCode = lang || this.lang;\n        return langCode ? this.data[langCode] : undefined;\n    }\n    getTranslationData(args) {\n        const { lang, key, keysetName, params } = args;\n        const languageData = this.getLanguageData(lang);\n        if (typeof languageData === 'undefined') {\n            return { details: { code: ErrorCode.NoLanguageData } };\n        }\n        if (Object.keys(languageData).length === 0) {\n            return { details: { code: ErrorCode.EmptyLanguageData } };\n        }\n        const keyset = languageData[keysetName];\n        if (!keyset) {\n            return { details: { code: ErrorCode.KeysetNotFound, keysetName } };\n        }\n        if (Object.keys(keyset).length === 0) {\n            return { details: { code: ErrorCode.EmptyKeyset, keysetName } };\n        }\n        const keyValue = keyset && keyset[key];\n        const result = {};\n        if (keyValue === undefined) {\n            return { details: { code: ErrorCode.MissingKey, keysetName, key } };\n        }\n        if (isPluralValue(keyValue)) {\n            const count = Number(params === null || params === void 0 ? void 0 : params.count);\n            if (Number.isNaN(count)) {\n                return { details: { code: ErrorCode.MissingKeyParamsCount, keysetName, key } };\n            }\n            result.text = getPluralValue({\n                key,\n                value: keyValue,\n                count,\n                lang: this.lang || 'en',\n                pluralizers: this.pluralizers,\n                log: (message) => this.warn(message, keysetName, key),\n            });\n        }\n        else {\n            result.text = keyValue;\n        }\n        if (params) {\n            result.text = replaceParams(result.text, params);\n        }\n        return result;\n    }\n}\n"],"names":[],"mappings":"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","x_google_ignoreList":[0]}