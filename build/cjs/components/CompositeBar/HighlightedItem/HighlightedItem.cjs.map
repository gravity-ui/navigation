{"version":3,"file":"HighlightedItem.cjs","sources":["../../../../../src/components/CompositeBar/HighlightedItem/HighlightedItem.tsx"],"sourcesContent":["import React, {useCallback, useEffect, useMemo, useState} from 'react';\n\nimport {Portal} from '@gravity-ui/uikit';\nimport debounceFn from 'lodash.debounce';\n\nimport {useAsideHeaderInnerContext} from '../../AsideHeader/AsideHeaderContext';\nimport {block} from '../../utils/cn';\n\nimport './HighlightedItem.scss';\n\nconst b = block('composite-bar-highlighted-item');\n\ninterface ItemInnerProps {\n    iconRef: React.RefObject<HTMLDivElement>;\n    iconNode: React.ReactNode;\n    onClick?: (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n    onClickCapture?: (event: React.SyntheticEvent) => void;\n}\n\nconst DEBOUNCE_TIME = 200;\n\nexport const HighlightedItem: React.FC<ItemInnerProps> = ({\n    iconRef,\n    iconNode,\n    onClick,\n    onClickCapture,\n}: ItemInnerProps) => {\n    const {openModalSubscriber} = useAsideHeaderInnerContext();\n    const [{top, left, width, height}, setPosition] = useState({\n        top: 0,\n        left: 0,\n        width: 0,\n        height: 0,\n    });\n    const [isModalOpen, setIsModalOpen] = useState<boolean>(false);\n\n    const handleResizeDebounced = useMemo(\n        () =>\n            debounceFn(\n                () => {\n                    const {\n                        top = 0,\n                        left = 0,\n                        width = 0,\n                        height = 0,\n                    } = iconRef?.current?.getBoundingClientRect() || {};\n\n                    setPosition({\n                        top: top + window.scrollY,\n                        left: left + window.scrollX,\n                        width,\n                        height,\n                    });\n                },\n                DEBOUNCE_TIME,\n                {leading: true},\n            ),\n        [iconRef],\n    );\n\n    const handleResize = useCallback(() => handleResizeDebounced(), [handleResizeDebounced]);\n\n    useEffect(() => {\n        if (!isModalOpen) {\n            return;\n        }\n\n        handleResize();\n\n        window.addEventListener('resize', handleResize);\n        return () => window.removeEventListener('resize', handleResize);\n    }, [handleResize, isModalOpen]);\n\n    openModalSubscriber?.((open: boolean) => {\n        setIsModalOpen(open);\n    });\n\n    if (!iconNode || !isModalOpen) {\n        return null;\n    }\n\n    return (\n        <Portal>\n            <div\n                className={b()}\n                style={{left, top, width, height}}\n                onClick={onClick}\n                onClickCapture={onClickCapture}\n                data-toast\n            >\n                <div className={b('icon')}>{iconNode}</div>\n            </div>\n        </Portal>\n    );\n};\n\nHighlightedItem.displayName = 'HighlightedItem';\n"],"names":["block","useAsideHeaderInnerContext","useState","useMemo","top","left","width","height","useCallback","useEffect","Portal","jsx"],"mappings":";;;;;;;;;;;;AAUA,MAAM,CAAA,GAAIA,SAAM,gCAAgC,CAAA,CAAA;AAShD,MAAM,aAAgB,GAAA,GAAA,CAAA;AAEf,MAAM,kBAA4C,CAAC;AAAA,EACtD,OAAA;AAAA,EACA,QAAA;AAAA,EACA,OAAA;AAAA,EACA,cAAA;AACJ,CAAsB,KAAA;AAClB,EAAM,MAAA,EAAC,mBAAmB,EAAA,GAAIC,6CAA2B,EAAA,CAAA;AACzD,EAAM,MAAA,CAAC,EAAC,GAAK,EAAA,IAAA,EAAM,OAAO,MAAM,EAAA,EAAG,WAAW,CAAA,GAAIC,cAAS,CAAA;AAAA,IACvD,GAAK,EAAA,CAAA;AAAA,IACL,IAAM,EAAA,CAAA;AAAA,IACN,KAAO,EAAA,CAAA;AAAA,IACP,MAAQ,EAAA,CAAA;AAAA,GACX,CAAA,CAAA;AACD,EAAA,MAAM,CAAC,WAAA,EAAa,cAAc,CAAA,GAAIA,eAAkB,KAAK,CAAA,CAAA;AAE7D,EAAA,MAAM,qBAAwB,GAAAC,aAAA;AAAA,IAC1B,MACI,UAAA;AAAA,MACI,MAAM;AACF,QAAM,MAAA;AAAA,UACF,KAAAC,IAAM,GAAA,CAAA;AAAA,UACN,MAAAC,KAAO,GAAA,CAAA;AAAA,UACP,OAAAC,MAAQ,GAAA,CAAA;AAAA,UACR,QAAAC,OAAS,GAAA,CAAA;AAAA,SACT,GAAA,OAAA,EAAS,OAAS,EAAA,qBAAA,MAA2B,EAAC,CAAA;AAElD,QAAY,WAAA,CAAA;AAAA,UACR,GAAA,EAAKH,OAAM,MAAO,CAAA,OAAA;AAAA,UAClB,IAAA,EAAMC,QAAO,MAAO,CAAA,OAAA;AAAA,UACpB,KAAAC,EAAAA,MAAAA;AAAA,UACA,MAAAC,EAAAA,OAAAA;AAAA,SACH,CAAA,CAAA;AAAA,OACL;AAAA,MACA,aAAA;AAAA,MACA,EAAC,SAAS,IAAI,EAAA;AAAA,KAClB;AAAA,IACJ,CAAC,OAAO,CAAA;AAAA,GACZ,CAAA;AAEA,EAAA,MAAM,eAAeC,iBAAY,CAAA,MAAM,uBAAyB,EAAA,CAAC,qBAAqB,CAAC,CAAA,CAAA;AAEvF,EAAAC,eAAA,CAAU,MAAM;AACZ,IAAA,IAAI,CAAC,WAAa,EAAA;AACd,MAAA,OAAA;AAAA,KACJ;AAEA,IAAa,YAAA,EAAA,CAAA;AAEb,IAAO,MAAA,CAAA,gBAAA,CAAiB,UAAU,YAAY,CAAA,CAAA;AAC9C,IAAA,OAAO,MAAM,MAAA,CAAO,mBAAoB,CAAA,QAAA,EAAU,YAAY,CAAA,CAAA;AAAA,GAC/D,EAAA,CAAC,YAAc,EAAA,WAAW,CAAC,CAAA,CAAA;AAE9B,EAAA,mBAAA,GAAsB,CAAC,IAAkB,KAAA;AACrC,IAAA,cAAA,CAAe,IAAI,CAAA,CAAA;AAAA,GACtB,CAAA,CAAA;AAED,EAAI,IAAA,CAAC,QAAY,IAAA,CAAC,WAAa,EAAA;AAC3B,IAAO,OAAA,IAAA,CAAA;AAAA,GACX;AAEA,EAAA,sCACKC,YACG,EAAA,EAAA,QAAA,kBAAAC,cAAA;AAAA,IAAC,KAAA;AAAA,IAAA;AAAA,MACG,WAAW,CAAE,EAAA;AAAA,MACb,KAAO,EAAA,EAAC,IAAM,EAAA,GAAA,EAAK,OAAO,MAAM,EAAA;AAAA,MAChC,OAAA;AAAA,MACA,cAAA;AAAA,MACA,YAAU,EAAA,IAAA;AAAA,MAEV,yCAAC,KAAI,EAAA,EAAA,SAAA,EAAW,CAAE,CAAA,MAAM,GAAI,QAAS,EAAA,QAAA,EAAA,CAAA;AAAA,KAAA;AAAA,GAE7C,EAAA,CAAA,CAAA;AAER,EAAA;AAEA,eAAA,CAAgB,WAAc,GAAA,iBAAA;;;;"}