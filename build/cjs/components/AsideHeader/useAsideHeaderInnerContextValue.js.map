{"version":3,"file":"useAsideHeaderInnerContextValue.js","sources":["../../../../../src/components/AsideHeader/useAsideHeaderInnerContextValue.tsx"],"sourcesContent":["import React, {useCallback, useEffect, useMemo, useState} from 'react';\n\nimport {AllPagesPanel, getAllPagesMenuItem} from '../AllPagesPanel';\nimport {MenuItem} from '../types';\n\nimport {AsideHeaderInnerContextType} from './AsideHeaderContext';\nimport {AsideHeaderProps, InnerPanels} from './types';\n\nconst EMPTY_MENU_ITEMS: MenuItem[] = [];\n\nexport const useAsideHeaderInnerContextValue = (\n    props: AsideHeaderProps & {size: number},\n): AsideHeaderInnerContextType => {\n    const {size, onClosePanel, menuItems, panelItems, onMenuItemsChanged} = props;\n    const [innerVisiblePanel, setInnerVisiblePanel] = useState<InnerPanels | undefined>();\n    const ALL_PAGES_MENU_ITEM = React.useMemo(() => {\n        return getAllPagesMenuItem();\n    }, []);\n\n    const allPagesIsAvailable =\n        Boolean(onMenuItemsChanged) && (!menuItems || menuItems?.length > 0);\n\n    useEffect(() => {\n        // If any user panel became visible we need to switch off all inner panels\n        if (panelItems?.some((x) => x.visible)) {\n            setInnerVisiblePanel(undefined);\n        }\n    }, [panelItems]);\n\n    const innerOnClosePanel = useCallback(() => {\n        setInnerVisiblePanel(undefined);\n        onClosePanel?.();\n    }, [onClosePanel]);\n\n    const onItemClick = useCallback(\n        (\n            item: MenuItem,\n            collapsed: boolean,\n            event: React.MouseEvent<HTMLDivElement, MouseEvent>,\n        ) => {\n            if (item.id === ALL_PAGES_MENU_ITEM.id) {\n                onClosePanel?.();\n                setInnerVisiblePanel((prev) =>\n                    prev === InnerPanels.AllPages ? undefined : InnerPanels.AllPages,\n                );\n            } else {\n                innerOnClosePanel();\n            }\n            item.onItemClick?.(item, collapsed, event);\n        },\n        [innerOnClosePanel, ALL_PAGES_MENU_ITEM, onClosePanel],\n    );\n\n    const innerMenuItems = useMemo(\n        () =>\n            allPagesIsAvailable\n                ? [\n                      ...(menuItems || EMPTY_MENU_ITEMS),\n                      {\n                          ...ALL_PAGES_MENU_ITEM,\n                          current: innerVisiblePanel === InnerPanels.AllPages,\n                      },\n                  ]\n                : menuItems || EMPTY_MENU_ITEMS,\n        [allPagesIsAvailable, menuItems, innerVisiblePanel, ALL_PAGES_MENU_ITEM],\n    );\n\n    const innerPanelItems = useMemo(() => {\n        if (!allPagesIsAvailable) {\n            return panelItems;\n        }\n        return [\n            ...(panelItems || []),\n            {\n                id: InnerPanels.AllPages,\n                content: <AllPagesPanel />,\n                visible: innerVisiblePanel === InnerPanels.AllPages,\n            },\n        ];\n    }, [allPagesIsAvailable, panelItems, innerVisiblePanel]);\n\n    return {\n        ...props,\n        onClosePanel: innerOnClosePanel,\n        allPagesIsAvailable,\n        menuItems: innerMenuItems,\n        panelItems: innerPanelItems,\n        size,\n        onItemClick,\n    };\n};\n"],"names":["useState","React","getAllPagesMenuItem","useEffect","useCallback","InnerPanels","useMemo","AllPagesPanel"],"mappings":";;;;;;;;;;;;;AAQA,MAAM,gBAAgB,GAAe,EAAE,CAAC;AAE3B,MAAA,+BAA+B,GAAG,CAC3C,KAAwC,KACX;AAC7B,IAAA,MAAM,EAAC,IAAI,EAAE,YAAY,EAAE,SAAS,EAAE,UAAU,EAAE,kBAAkB,EAAC,GAAG,KAAK,CAAC;IAC9E,MAAM,CAAC,iBAAiB,EAAE,oBAAoB,CAAC,GAAGA,cAAQ,EAA2B,CAAC;AACtF,IAAA,MAAM,mBAAmB,GAAGC,yBAAK,CAAC,OAAO,CAAC,MAAK;QAC3C,OAAOC,6BAAmB,EAAE,CAAC;KAChC,EAAE,EAAE,CAAC,CAAC;IAEP,MAAM,mBAAmB,GACrB,OAAO,CAAC,kBAAkB,CAAC,KAAK,CAAC,SAAS,IAAI,CAAA,SAAS,KAAA,IAAA,IAAT,SAAS,KAAT,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,SAAS,CAAE,MAAM,IAAG,CAAC,CAAC,CAAC;IAEzEC,eAAS,CAAC,MAAK;;AAEX,QAAA,IAAI,UAAU,KAAV,IAAA,IAAA,UAAU,KAAV,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,UAAU,CAAE,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,EAAE;YACpC,oBAAoB,CAAC,SAAS,CAAC,CAAC;AACnC,SAAA;AACL,KAAC,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC;AAEjB,IAAA,MAAM,iBAAiB,GAAGC,iBAAW,CAAC,MAAK;QACvC,oBAAoB,CAAC,SAAS,CAAC,CAAC;AAChC,QAAA,YAAY,KAAZ,IAAA,IAAA,YAAY,KAAZ,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,YAAY,EAAI,CAAC;AACrB,KAAC,EAAE,CAAC,YAAY,CAAC,CAAC,CAAC;IAEnB,MAAM,WAAW,GAAGA,iBAAW,CAC3B,CACI,IAAc,EACd,SAAkB,EAClB,KAAmD,KACnD;;AACA,QAAA,IAAI,IAAI,CAAC,EAAE,KAAK,mBAAmB,CAAC,EAAE,EAAE;AACpC,YAAA,YAAY,KAAZ,IAAA,IAAA,YAAY,KAAZ,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,YAAY,EAAI,CAAC;YACjB,oBAAoB,CAAC,CAAC,IAAI,KACtB,IAAI,KAAKC,iBAAW,CAAC,QAAQ,GAAG,SAAS,GAAGA,iBAAW,CAAC,QAAQ,CACnE,CAAC;AACL,SAAA;AAAM,aAAA;AACH,YAAA,iBAAiB,EAAE,CAAC;AACvB,SAAA;QACD,CAAA,EAAA,GAAA,IAAI,CAAC,WAAW,MAAG,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,IAAA,CAAA,IAAA,EAAA,IAAI,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;KAC9C,EACD,CAAC,iBAAiB,EAAE,mBAAmB,EAAE,YAAY,CAAC,CACzD,CAAC;AAEF,IAAA,MAAM,cAAc,GAAGC,aAAO,CAC1B,MACI,mBAAmB;AACf,UAAE;AACI,YAAA,IAAI,SAAS,IAAI,gBAAgB,CAAC;AAE3B,YAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,mBAAmB,KACtB,OAAO,EAAE,iBAAiB,KAAKD,iBAAW,CAAC,QAAQ,EAAA,CAAA;AAE1D,SAAA;AACH,UAAE,SAAS,IAAI,gBAAgB,EACvC,CAAC,mBAAmB,EAAE,SAAS,EAAE,iBAAiB,EAAE,mBAAmB,CAAC,CAC3E,CAAC;AAEF,IAAA,MAAM,eAAe,GAAGC,aAAO,CAAC,MAAK;QACjC,IAAI,CAAC,mBAAmB,EAAE;AACtB,YAAA,OAAO,UAAU,CAAC;AACrB,SAAA;QACD,OAAO;AACH,YAAA,IAAI,UAAU,IAAI,EAAE,CAAC;AACrB,YAAA;gBACI,EAAE,EAAED,iBAAW,CAAC,QAAQ;gBACxB,OAAO,EAAEJ,yBAAC,CAAA,aAAA,CAAAM,2BAAa,EAAG,IAAA,CAAA;AAC1B,gBAAA,OAAO,EAAE,iBAAiB,KAAKF,iBAAW,CAAC,QAAQ;AACtD,aAAA;SACJ,CAAC;KACL,EAAE,CAAC,mBAAmB,EAAE,UAAU,EAAE,iBAAiB,CAAC,CAAC,CAAC;AAEzD,IAAA,OAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EACO,KAAK,CACR,EAAA,EAAA,YAAY,EAAE,iBAAiB,EAC/B,mBAAmB,EACnB,SAAS,EAAE,cAAc,EACzB,UAAU,EAAE,eAAe,EAC3B,IAAI;AACJ,QAAA,WAAW,EACb,CAAA,CAAA;AACN;;;;"}