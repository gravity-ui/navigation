{"version":3,"file":"AllPagesPanel.js","sources":["../../../../../src/components/AllPagesPanel/AllPagesPanel.tsx"],"sourcesContent":["import React, {useCallback, useEffect, useRef, useState} from 'react';\n\nimport {Gear} from '@gravity-ui/icons';\nimport {Button, Flex, Icon, List, ListItemData, Text} from '@gravity-ui/uikit';\n\nimport {useAsideHeaderInnerContext} from '../AsideHeader/AsideHeaderContext';\nimport {MenuItem} from '../types';\nimport {block} from '../utils/cn';\n\nimport {AllPagesListItem} from './AllPagesListItem';\nimport {ALL_PAGES_ID} from './constants';\nimport i18n from './i18n';\nimport {useGroupedMenuItems} from './useGroupedMenuItems';\n\nimport './AllPagesPanel.scss';\n\nconst b = block('all-pages-panel');\n\ninterface AllPagesPanelProps {\n    className?: string;\n    startEditIcon?: React.ReactNode;\n    onEditModeChanged?: (isEditMode: boolean) => void;\n}\n\nexport const AllPagesPanel: React.FC<AllPagesPanelProps> = (props) => {\n    const {startEditIcon, onEditModeChanged, className} = props;\n    const {menuItems, onMenuItemsChanged} = useAsideHeaderInnerContext();\n    const menuItemsRef = useRef(menuItems);\n    menuItemsRef.current = menuItems;\n\n    const [isEditMode, setIsEditMode] = useState(false);\n    const toggleEditMode = useCallback(() => {\n        setIsEditMode((prev) => !prev);\n    }, []);\n\n    const groupedItems = useGroupedMenuItems(menuItems);\n\n    useEffect(() => {\n        onEditModeChanged?.(isEditMode);\n    }, [isEditMode, onEditModeChanged]);\n\n    const onItemClick = useCallback((item: ListItemData<MenuItem>) => {\n        //@ts-ignore TODO fix when @gravity-ui/uikit/List will provide event arg on item click\n        item.onItemClick?.(item, false);\n    }, []);\n\n    const togglePageVisibility = useCallback(\n        (item: MenuItem) => {\n            if (!onMenuItemsChanged) {\n                return;\n            }\n            const changedItem: MenuItem = {...item, hidden: !item.hidden};\n\n            const originItems = menuItemsRef.current.filter(\n                (menuItem) => menuItem.id !== ALL_PAGES_ID,\n            );\n            onMenuItemsChanged(\n                originItems.map((menuItem) => {\n                    if (menuItem.id !== changedItem.id) {\n                        return menuItem;\n                    }\n                    return changedItem;\n                }),\n            );\n        },\n        [onMenuItemsChanged],\n    );\n\n    const itemRender = useCallback(\n        (item: ListItemData<MenuItem>, _isActive: boolean, _itemIndex: number) => (\n            <AllPagesListItem\n                item={item}\n                editMode={isEditMode}\n                onToggle={() => togglePageVisibility(item)}\n            />\n        ),\n        [isEditMode, togglePageVisibility],\n    );\n\n    const onResetToDefaultClick = useCallback(() => {\n        if (!onMenuItemsChanged) {\n            return;\n        }\n        const originItems = menuItemsRef.current.filter((item) => item.id !== ALL_PAGES_ID);\n        onMenuItemsChanged(\n            originItems.map((item) => ({\n                ...item,\n                hidden: false,\n            })),\n        );\n    }, [onMenuItemsChanged]);\n    return (\n        <Flex className={b(null, className)} gap=\"5\" direction=\"column\">\n            <Flex gap=\"4\" alignItems=\"center\" justifyContent=\"space-between\">\n                <Text variant=\"subheader-2\">\n                    {isEditMode ? i18n('all-panel.title.editing') : i18n('all-panel.title.main')}\n                </Text>\n                <Button selected={isEditMode} view=\"normal\" onClick={toggleEditMode}>\n                    {startEditIcon ? startEditIcon : <Icon data={Gear} />}\n                </Button>\n            </Flex>\n            <Flex className={b('content')} gap=\"5\" direction=\"column\">\n                {Object.keys(groupedItems).map((category) => {\n                    return (\n                        <Flex key={category} direction=\"column\" gap=\"3\">\n                            <Text className={b('category')} variant=\"body-1\" color=\"secondary\">\n                                {category}\n                            </Text>\n                            <List\n                                virtualized={false}\n                                filterable={false}\n                                items={groupedItems[category]}\n                                onItemClick={onItemClick}\n                                renderItem={itemRender}\n                            />\n                        </Flex>\n                    );\n                })}\n            </Flex>\n            {isEditMode && (\n                <Button onClick={onResetToDefaultClick}>{i18n('all-panel.resetToDefault')}</Button>\n            )}\n        </Flex>\n    );\n};\n"],"names":["block","useAsideHeaderInnerContext","useRef","useState","useCallback","useGroupedMenuItems","useEffect","ALL_PAGES_ID","React","AllPagesListItem","Flex","Text","i18n","Button","Icon","Gear","List"],"mappings":"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"}