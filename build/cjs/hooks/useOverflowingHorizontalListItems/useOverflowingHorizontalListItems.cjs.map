{"version":3,"file":"useOverflowingHorizontalListItems.cjs","sources":["../../../../src/hooks/useOverflowingHorizontalListItems/useOverflowingHorizontalListItems.ts"],"sourcesContent":["import {useLayoutEffect, useMemo, useState} from 'react';\nimport type {RefObject} from 'react';\n\nimport debounceFn from 'lodash.debounce';\n\nexport type UseOverflowingContainerListItemsProps<ItemType extends unknown> = {\n    containerRef: RefObject<HTMLElement>;\n    items?: ItemType[];\n    itemSelector: string;\n    moreButtonWidth?: number;\n};\n\nexport function useOverflowingHorizontalListItems<ItemType>({\n    containerRef,\n    items,\n    itemSelector,\n    moreButtonWidth = 0,\n}: UseOverflowingContainerListItemsProps<ItemType>) {\n    const [containerWidth, setContainerWidth] = useState<number>(0);\n    const [itemWidths, setItemWidths] = useState<number[]>([]);\n\n    useLayoutEffect(() => {\n        if (!containerRef.current) {\n            return;\n        }\n\n        const measureItemSizes = () => {\n            const itemElements = Array.from(\n                containerRef.current?.querySelectorAll(itemSelector) ?? [],\n            );\n            setItemWidths(itemElements.map((item) => item.clientWidth));\n        };\n\n        measureItemSizes();\n    }, [containerRef, itemSelector]);\n\n    useLayoutEffect(() => {\n        const footerMenu = containerRef.current;\n        if (!footerMenu) {\n            return;\n        }\n\n        const updateContainerSize = (entries: ResizeObserverEntry[]) => {\n            if (entries.length > 0 && footerMenu) {\n                setContainerWidth(entries[0].contentRect.width);\n            }\n        };\n\n        const updateContainerSizeDebounced = debounceFn(updateContainerSize, 100);\n        const footerMenuResizeObserver = new ResizeObserver(updateContainerSizeDebounced);\n\n        footerMenuResizeObserver.observe(footerMenu);\n    }, [containerRef]);\n\n    const isMeasured = containerWidth > 0;\n\n    const {visibleItems, hiddenItems} = useMemo(() => {\n        if (!isMeasured) {\n            return {\n                visibleItems: items ?? [],\n                hiddenItems: [],\n            };\n        }\n\n        const itemsCount = itemWidths.length;\n        let visibleItemsCount = 0;\n        let remainingContainerWidth = containerWidth;\n        for (const width of itemWidths) {\n            remainingContainerWidth -= width;\n            if (remainingContainerWidth < moreButtonWidth) {\n                const isMoreThanOneItemLeft = itemsCount !== visibleItemsCount + 1;\n                const hasNoSpaceForTheLastItem = remainingContainerWidth < 0;\n                if (isMoreThanOneItemLeft || hasNoSpaceForTheLastItem) {\n                    break;\n                }\n            }\n\n            visibleItemsCount++;\n        }\n\n        return {\n            visibleItems: items?.slice(0, visibleItemsCount) ?? [],\n            hiddenItems: items?.slice(visibleItemsCount) ?? [],\n        };\n    }, [containerWidth, isMeasured, itemWidths, items, moreButtonWidth]);\n\n    return {visibleItems, hiddenItems, measured: isMeasured};\n}\n"],"names":["useState","useLayoutEffect","useMemo"],"mappings":"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"}